fileVersion: 1
id: 61d3bcca-fefc-4635-8450-98061b06784a
name: STG_LINEITEM_ORDERS_DIM_LOOKUP
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae7dc3b5-15df-4463-a8a1-bce2f7f3e88b
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_CUSTOMER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ce3533e-a13b-421e-9754-b8379fb05c60
                stepCounter: c1a37730-a48d-47e3-8599-51aedb0b8561
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ec7918-01ab-4ba6-bf1d-459fa12cb25a
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_PART_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f934f3d5-5748-40d4-bb68-b99cb2940e11
                stepCounter: 526eebf4-51ff-4a3b-b3de-14c6af5a69d3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb0dc45-013c-4b9e-a783-fe193c17133f
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER
        description: ""
        name: DIM_SUPPLIER_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d067291e-d599-4c9f-8397-264f3d28f00d
                stepCounter: db6628e0-3835-402f-a2ab-d4db2ee378f2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d28f0e96-9578-4284-8f35-9d92c242bbc4
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a4b2606-8f7d-44eb-94dd-7c06e9ea6063
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 77b55d87-06dd-4e4b-a83b-0ea92ee49d25
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a10ea37-d9b9-4a62-b5c1-bd166e09efbc
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cff55b9b-1d16-423b-8d8d-685afc82dd2f
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a4153e93-b545-48de-8f0d-304a9672f045
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 80b96a54-c966-407a-82d6-dff19e03cd26
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8f57a5f-d058-4274-b680-a2a6f8dc281e
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e636430-4e08-4367-b3fd-ce9e4fdf426f
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad762b47-f0d9-4bb8-a0ea-8003b53398e4
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce4a9a45-a4fc-4bc7-b0c5-9f08d0e187fa
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 704beb33-da0f-4c5e-a893-75afed1e1e2f
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3200b6d-6589-448b-ae57-b59ba3f38042
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 94457a8a-1c3c-434e-8304-540572c2ac23
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: afe318c3-2150-4ac5-9491-32e4d859d54e
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3df60009-bc40-4f2c-9f3b-c2eed174cfaf
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 485404f8-bccd-4872-b51d-7b9f8ed0cbec
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b50275c5-0a86-4806-9f45-6912d3a0f74b
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a693a7ea-4a47-4d9c-809c-dc2aa866bdec
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffa35edd-0fe2-4bd0-97a6-708798e6f642
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c4ca3d2-495c-402f-a606-26b0c7f0a201
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd073116-7921-4c14-94a5-f754d8b1955b
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ce26e11-d735-4b02-bfc3-9f20ca5a1ec0
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f1e74403-f2d7-40f4-b139-9809d8cfe3c1
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 95b19ca2-e0a8-4209-9be7-4ef160ccb045
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: efd7f6ac-e12f-4960-bfc3-72c6e91449d5
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4f381f4-0c9c-477e-8e14-32b362512780
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e17a4d75-fb80-4d9e-9eb7-94f7da92a83e
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92210db7-1c2e-4c71-bb3f-dff1eb921d66
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 964ea9ea-16a5-4d15-b10d-66842a27b063
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d866c55e-d628-427a-be96-5180dca9f83f
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 087113c5-6944-4fde-ad4a-2db0e7952593
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 673c3efd-fd6e-4cfe-9ec6-4be73f7b558e
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eb65e3c8-50bb-4494-b12e-07e28477c0b1
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f886c7f1-edae-4a59-8624-82e26e3bef6d
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72a1b8af-671e-42f3-8557-4852ad5240b7
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ba62583-0e90-4cb0-a5a8-207745b60065
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ebde430-7d00-41bf-80ed-854eca2c018c
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ddbebc-f3d3-4ced-9533-43571b0dc8e9
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69f9cfb5-5554-43a4-b0a9-1c7b8d839370
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3c4dbc31-2a0d-464e-b1e6-22e42ebe4926
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a363c88a-302a-470f-9cae-a3bd01f9afd0
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9638db0e-f999-4e49-9138-f81633667c45
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9528511-b2c8-47ba-adad-3e4e8a575581
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9e9819c3-26d1-4af4-ad4f-5bb26b1925f4
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: add04bc5-430a-4897-8272-23fa29355b1b
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 50472846-c483-4146-ad81-8dc28629a822
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c34d11a1-8139-497a-94f8-512a66463f6a
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21500a64-950b-4582-ac8b-7fcaa4afc4ee
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2423de24-8096-4414-a5fd-40f7da9ea047
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17d7caaa-df82-4877-a932-156f54508fb0
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8854fed5-26e0-4f02-a100-a5fe8a4a8b7a
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c87572db-de56-4b58-8d11-6eefe2333d16
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e0c33e6-1f79-4595-bbc2-64cc2379b8b0
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bccbedbe-d6a1-4755-b85f-f102490af322
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER
        description: ""
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ae1a5dcd-d1ef-4db7-8491-7406d036bd12
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7d51bec1-63d0-411a-b3ed-4723c75f5a08
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d0c4342-3382-4276-90cb-7616b891a0a9
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 77577d74-bd9d-47b8-a7a7-74b700490108
          stepCounter: 61d3bcca-fefc-4635-8450-98061b06784a
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: caa53cc3-3d1a-4d22-a087-ca7e5c6a23bd
                stepCounter: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          DIM_CUSTOMER: c1a37730-a48d-47e3-8599-51aedb0b8561
          DIM_PART: 526eebf4-51ff-4a3b-b3de-14c6af5a69d3
          DIM_SUPPLIER: db6628e0-3835-402f-a2ab-d4db2ee378f2
          STG_LINEITEM_ORDERS: 87d6a1ff-65b1-4b00-a89b-a87423f833a3
          STG_PARTSUPP: 0af90213-6e6d-40a5-9966-6deae8b8088e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: DIM_CUSTOMER
          - locationName: WORK
            nodeName: DIM_PART
          - locationName: WORK
            nodeName: DIM_SUPPLIER
          - locationName: WORK
            nodeName: STG_LINEITEM_ORDERS
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
            
            LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
            
            ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
            
            AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
            
            /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
            
            LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
            
            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
            
            LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
            
            ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
            
            LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
            
            ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
            
            "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS_DIM_LOOKUP
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS_DIM_LOOKUP
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
